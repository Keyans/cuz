import{_ as O}from"./CBeqNIc1.js";import{e as q,q as P,E as Y,D as _,c as x,J as M,o as k,a as t,s as W,O as X,r as h,P as z,b as f,d as m,Q as B,t as F,H as T,K as D,w as c,l as u,n as $,R as j,S as A,U as L}from"./BCXaO8k1.js";import{_ as E}from"./CljIk_-U.js";import{_ as H}from"./D8BYP-1q.js";import{d as N}from"./Dk_0FWyk.js";import{D as K}from"./CWqMvATA.js";var I=(d=>(d.UP="UP",d.DOWN="DOWN",d.MOVE="MOVE",d.CLICK="CLICK",d))(I||{});const R=["width"],G=q({__name:"SliderCaptcha",props:{modelValue:{type:Boolean,required:!0},scale:{type:Number,default:2},smsType:{type:String,default:null},getForm:{type:Function,required:!0},doSubmit:{type:Function,required:!0}},emits:["update:modelValue","success"],setup(d,{emit:p}){const r=d,g=p,l=P(()=>{const e=a.trackList,o=e.length;if(!e||o<=0)return 0;const i=0,w=(a.bgImageWidth-a.sliderImageWidth)*r.scale,y=e[o-1].x*r.scale;return y<=i?i:y>=w?w:y}),s=Y({isShow:!0,sliderValue:0,captcha:{id:"",startX:0,startY:0,bgImage:"",sliderImage:""}}),a=Y({bgImageWidth:0,bgImageHeight:0,sliderImageWidth:0,sliderImageHeight:0,startSlidingTime:"",endSlidingTime:"",startTime:new Date,trackList:[]}),b=async()=>{const e=await X();console.log("hello",e);const{code:o,data:i}=e;console.log(o,i),o===200&&C(i)};_(()=>r.modelValue,e=>{s.isShow=e,e&&b()},{immediate:!0}),_(()=>s.isShow,e=>g("update:modelValue",e));const C=({id:e,captcha:o})=>{s.sliderValue=0,s.captcha.id=e,s.captcha.startX=0,s.captcha.startY=0,s.captcha.bgImage=o.backgroundImage,s.captcha.sliderImage=o.sliderImage,a.startTime=new Date,a.bgImageWidth=o.backgroundImageWidth/r.scale,a.bgImageHeight=o.backgroundImageHeight/r.scale,a.sliderImageWidth=o.sliderImageWidth/r.scale,a.sliderImageHeight=o.sliderImageHeight/r.scale,a.startSlidingTime=N(a.startTime).format("YYYY/MM/DD hh:mm:ss"),a.trackList=[]},v=e=>{const o=e.target;s.captcha.startX=e.clientX,s.captcha.startY=e.clientY,a.trackList=[],a.trackList.push({x:0,y:0,type:I.DOWN,t:new Date().getTime()-a.startTime.getTime()}),o.ondragstart=()=>!1,o.onmousemove=S,o.onmouseup=V},S=e=>{a.trackList.push({x:e.clientX-s.captcha.startX,y:e.clientY-s.captcha.startY,type:I.MOVE,t:new Date().getTime()-a.startTime.getTime()})},V=e=>{const o=e.target;o.onmousemove=null,o.onmouseup=null,a.endSlidingTime=N().format("YYYY-MM-DD hh:mm:ss"),a.trackList.push({x:e.clientX-s.captcha.startX,y:e.clientY-s.captcha.startY,type:I.UP,t:new Date().getTime()-a.startTime.getTime()}),r.doSubmit(n()).then(i=>{const{code:w,msg:y}=i;if(w===200){g("success",i);return}y&&console.error(y),b()})},n=()=>r.smsType?{form:r.getForm(),id:s.captcha.id,captchaTrack:a,smsType:r.smsType}:{form:r.getForm(),id:s.captcha.id,captchaTrack:a};return(e,o)=>s.isShow?(k(),x("div",{key:0,class:"signDialog",width:a.bgImageWidth*r.scale,"show-close":!1},[t("div",{style:W([{position:"relative"},{height:a.bgImageHeight*r.scale+"px",width:a.bgImageWidth*r.scale+"px",backgroundImage:"url("+s.captcha.bgImage+")",backgroundSize:"100% 100%"}])},[t("div",{style:W([{color:"#4ceed6",border:"#4cd964",position:"absolute"},{backgroundImage:`url(${s.captcha.sliderImage})`,left:l.value+"px",height:a.sliderImageHeight*r.scale+"px",width:a.sliderImageWidth*r.scale+"px"}]),onMousedown:v},null,36)],4)],8,R)):M("",!0)}}),J={class:"min-h-screen bg-background flex w-full justify-center relative"},Q={class:"self-center -mt-[10%] sm:mx-auto sm:w-full sm:max-w-md relative"},Z={class:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10"},ee={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"},te={class:"mt-1"},ae={class:"mt-1"},se={class:"flex mt-1 w-full space-x-1"},oe=["disabled"],re={key:0,class:"mr-2"},ie={class:"mt-4 text-center text-xs text-gray-500"},le="/assets/login_bg.png",U=120,ge=q({__name:"login",setup(d){const p=h(""),r=h(""),g=h(""),l=Y({showSliderCaptcha:!1,shop:null,visible:!1,shops:[],account:null,password:null,disabled:!1,time:U,interval:null});h(!1),h(!1);const s=h(!1),a=h(null),b=n=>{g.value=n.data,l.time-=1,l.showSliderCaptcha=!1,l.interval=A(()=>{if(l.time-=1,l.time<=0){l.time=U,l.interval&&(clearInterval(l.interval),l.interval=null);return}},999)},C=()=>{p.value&&(l.showSliderCaptcha=!0)},v=z(),S=async()=>{s.value=!0,a.value=null;try{await v.login({email:"demo@example.com",password:"password123",grant_type:"email"}),L("/dashboard")}catch(n){a.value=n.message||"Failed to login with demo account. Please try again."}finally{s.value=!1}},V=async()=>{s.value=!0,a.value=null;try{await v.login({mobile:p.value,code:g.value,grant_type:"sms_code"}),L("/dashboard")}catch(n){a.value=n.message||"Failed to login. Please check your credentials."}finally{s.value=!1}};return(n,e)=>{const o=O;return k(),x("div",J,[t("button",{onClick:e[0]||(e[0]=i=>n.$router.back()),class:"absolute top-4 right-4 p-2 rounded-full hover:bg-gray-100 transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50"},e[6]||(e[6]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])),t("div",{class:"flex-grow-0 flex-shrink-0 basis-[41%] bg-cover hidden lg:block relative",style:W({backgroundImage:`url(${le})`})},null,4),t("div",Q,[e[19]||(e[19]=t("div",{class:"flex flex-col items-center mb-8"},[t("img",{src:E,alt:"cuzcuz",class:"h-40 w-auto"}),t("h2",{class:"text-xl font-medium text-gray-700 mt-2"},"全球POD柔性定制供应链平台")],-1)),t("div",Z,[t("div",{class:"mb-6"},[t("button",{onClick:S,class:"w-full flex justify-center items-center py-2 px-4 border border-dashed border-primary rounded-md shadow-sm text-sm font-medium text-primary bg-secondary bg-opacity-30 hover:bg-opacity-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary transition-colors"},e[7]||(e[7]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"})],-1),m(" 登录体验账号 (无需输入) ")]))]),t("form",{class:"space-y-6",onSubmit:B(V,["prevent"])},[a.value?(k(),x("div",ee,F(a.value),1)):M("",!0),t("div",null,[e[8]||(e[8]=t("label",{for:"phone",class:"block text-sm font-medium text-gray-700"}," 手机号 ",-1)),t("div",te,[T(t("input",{id:"phone","onUpdate:modelValue":e[1]||(e[1]=i=>p.value=i),name:"phone",type:"text",autocomplete:"phone",required:"",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"},null,512),[[D,p.value]])])]),t("div",null,[e[9]||(e[9]=t("label",{for:"invitation",class:"block text-sm font-medium text-gray-700"}," 邀请码 ",-1)),t("div",ae,[T(t("input",{id:"invitation","onUpdate:modelValue":e[2]||(e[2]=i=>r.value=i),name:"invitation",type:"text",required:"",class:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"},null,512),[[D,r.value]])])]),t("div",null,[e[10]||(e[10]=t("label",{for:"captcha",class:"block text-sm font-medium text-gray-700"}," 验证码 ",-1)),t("div",se,[T(t("input",{id:"captcha","onUpdate:modelValue":e[3]||(e[3]=i=>g.value=i),name:"captcha",type:"text",required:"",class:"appearance-none block flex-1 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary focus:border-primary sm:text-sm"},null,512),[[D,g.value]]),f(u(H),{"while-hover":{opacity:.6}},{default:c(()=>[t("button",{type:"button",class:"bg-white px-4 rounded-sm text-gray-600 border-gray-300 border h-full shadow-sm hover:bg-gray-50 transition-colors",onClick:C}," 获取验证码 ")]),_:1})])]),t("div",null,[f(u(H),{"while-hover":{scale:1.05,opacity:.9},"while-press":{scale:.95}},{default:c(()=>[t("button",{type:"submit",disabled:s.value,class:$(["w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-primary bg-secondary hover:opacity-90 transition-opacity",{"opacity-75 cursor-not-allowed":s.value}])},[s.value?(k(),x("span",re,e[11]||(e[11]=[t("svg",{class:"animate-spin h-5 w-5 text-primary",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)]))):M("",!0),e[12]||(e[12]=m(" 登 录 / 注 册 "))],10,oe)]),_:1})]),t("div",ie,[e[16]||(e[16]=m(" 登录/注册即代表您同意 ")),f(o,{to:"/agreement",class:"text-primary hover:opacity-80 transition-opacity"},{default:c(()=>e[13]||(e[13]=[m("《用户服务协议》")])),_:1}),e[17]||(e[17]=m("、 ")),f(o,{to:"/privacy",class:"text-primary hover:opacity-80 transition-opacity"},{default:c(()=>e[14]||(e[14]=[m("《隐私权政策》")])),_:1}),e[18]||(e[18]=m("、 ")),f(o,{to:"/ip-policy",class:"text-primary hover:opacity-80 transition-opacity"},{default:c(()=>e[15]||(e[15]=[m("《知识产权政策》")])),_:1})])],32)])]),f(u(K),{modelValue:u(l).showSliderCaptcha,"onUpdate:modelValue":e[5]||(e[5]=i=>u(l).showSliderCaptcha=i)},{header:c(()=>e[20]||(e[20]=[])),footer:c(()=>e[21]||(e[21]=[])),default:c(()=>[f(G,{modelValue:u(l).showSliderCaptcha,"onUpdate:modelValue":e[4]||(e[4]=i=>u(l).showSliderCaptcha=i),"do-submit":u(j),"get-form":()=>p.value,scale:1,onSuccess:b},null,8,["modelValue","do-submit","get-form"])]),_:1},8,["modelValue"])])}}});export{ge as default};

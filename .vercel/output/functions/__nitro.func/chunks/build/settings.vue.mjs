import{v as e,k as a,l as t,m as s,n as o,s as d,_ as r,o as n}from"./server.mjs";import{b as l,d as i,w as u}from"./index3.mjs";import{m as c,i as v,a as p}from"./config-provider.mjs";import{A as f}from"./AddressDialog.vue.mjs";import"source-map-js";import"../nitro/nitro.mjs";import"node:http";import"node:https";import"node:events";import"node:buffer";import"node:fs";import"node:path";import"node:crypto";import"node:url";import"ipx";import"lodash-unified";import"../routes/renderer.mjs";import"unhead/server";import"unhead/plugins";import"unhead/utils";import"@vue/compiler-dom";import"@vue/runtime-dom";import"@vue/shared";import"@vue/server-renderer";import"devalue";import"node:stream";const m=["success","info","warning","error"],b=c({customClass:"",center:!1,dangerouslyUseHTMLString:!1,duration:3e3,icon:void 0,id:"",message:"",onClose:void 0,showClose:!1,type:"info",plain:!1,offset:16,zIndex:0,grouping:!1,repeatNum:1,appendTo:void 0});l({customClass:{type:String,default:b.customClass},center:{type:Boolean,default:b.center},dangerouslyUseHTMLString:{type:Boolean,default:b.dangerouslyUseHTMLString},duration:{type:Number,default:b.duration},icon:{type:v,default:b.icon},id:{type:String,default:b.id},message:{type:i([String,Object,Function]),default:b.message},onClose:{type:i(Function),default:b.onClose},showClose:{type:Boolean,default:b.showClose},type:{type:String,values:m,default:b.type},plain:{type:Boolean,default:b.plain},offset:{type:Number,default:b.offset},zIndex:{type:Number,default:b.zIndex},grouping:{type:Boolean,default:b.grouping},repeatNum:{type:Number,default:b.repeatNum}});const x=e.shallowReactive([]),message=(e={},a)=>({close:()=>{}});m.forEach((d=>{message[d]=(d={},r)=>{(d=>{const r=!d||a.isString(d)||e.isVNode(d)||a.isFunction(d)?{message:d}:d,n={...b,...r};if(n.appendTo){if(a.isString(n.appendTo)){let e=(void 0).querySelector(n.appendTo);t(e)||(e=(void 0).body),n.appendTo=e}}else n.appendTo=(void 0).body;s(p.grouping)&&!n.grouping&&(n.grouping=p.grouping),o(p.duration)&&3e3===n.duration&&(n.duration=p.duration),o(p.offset)&&16===n.offset&&(n.offset=p.offset),s(p.showClose)&&!n.showClose&&(n.showClose=p.showClose)})(d);return{close:()=>{}}}})),message.closeAll=function(e){for(const a of x)e&&e!==a.props.type||a.handler.close()},message._context=null;const g=u(message,"$message"),y=e.defineComponent({__name:"InvoiceDialog",__ssrInlineRender:!0,props:{show:{type:Boolean},invoiceInfo:{}},emits:["update:show","save"],setup(a,{emit:t}){var s,o,r,n,l,i;const u=a,c=e.reactive({companyName:(null==(s=u.invoiceInfo)?void 0:s.companyName)||"",taxNumber:(null==(o=u.invoiceInfo)?void 0:o.taxNumber)||"",address:(null==(r=u.invoiceInfo)?void 0:r.address)||"",phone:(null==(n=u.invoiceInfo)?void 0:n.phone)||"",bankName:(null==(l=u.invoiceInfo)?void 0:l.bankName)||"",bankAccount:(null==(i=u.invoiceInfo)?void 0:i.bankAccount)||""});return e.watch((()=>u.invoiceInfo),(e=>{e&&(c.companyName=e.companyName||"",c.taxNumber=e.taxNumber||"",c.address=e.address||"",c.phone=e.phone||"",c.bankName=e.bankName||"",c.bankAccount=e.bankAccount||"")}),{immediate:!0}),(a,t,s,o)=>{a.show?t(`<div${d.ssrRenderAttrs(e.mergeProps({class:"fixed inset-0 z-50 overflow-y-auto"},o))} data-v-a1909632><div class="flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0" data-v-a1909632><div class="fixed inset-0 transition-opacity" data-v-a1909632><div class="absolute inset-0 bg-gray-500 opacity-75" data-v-a1909632></div></div><div class="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full" data-v-a1909632><div class="bg-white px-6 pt-5 pb-4" data-v-a1909632><div class="flex justify-between items-center mb-6" data-v-a1909632><h3 class="text-xl font-medium text-gray-900" data-v-a1909632>编辑</h3><button class="text-gray-400 hover:text-gray-500" data-v-a1909632><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-a1909632><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" data-v-a1909632></path></svg></button></div><form class="space-y-5" data-v-a1909632><div class="flex items-center" data-v-a1909632><label class="block w-24 text-gray-700" data-v-a1909632> 公司名称 <span class="text-red-500 ml-0.5" data-v-a1909632>*</span></label><input${d.ssrRenderAttr("value",c.companyName)} type="text" class="flex-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请输入" required data-v-a1909632></div><div class="flex items-center" data-v-a1909632><label class="block w-24 text-gray-700" data-v-a1909632> 税号 <span class="text-red-500 ml-0.5" data-v-a1909632>*</span></label><input${d.ssrRenderAttr("value",c.taxNumber)} type="text" class="flex-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请输入" required data-v-a1909632></div><div class="flex items-center" data-v-a1909632><label class="block w-24 text-gray-700" data-v-a1909632> 单位地址 <span class="text-red-500 ml-0.5" data-v-a1909632>*</span></label><input${d.ssrRenderAttr("value",c.address)} type="text" class="flex-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请输入" required data-v-a1909632></div><div class="flex items-center" data-v-a1909632><label class="block w-24 text-gray-700" data-v-a1909632> 电话号码 <span class="text-red-500 ml-0.5" data-v-a1909632>*</span></label><input${d.ssrRenderAttr("value",c.phone)} type="tel" class="flex-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请输入" required data-v-a1909632></div><div class="flex items-center" data-v-a1909632><label class="block w-24 text-gray-700" data-v-a1909632> 开户银行 <span class="text-red-500 ml-0.5" data-v-a1909632>*</span></label><input${d.ssrRenderAttr("value",c.bankName)} type="text" class="flex-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请输入" required data-v-a1909632></div><div class="flex items-center" data-v-a1909632><label class="block w-24 text-gray-700" data-v-a1909632> 银行账户 <span class="text-red-500 ml-0.5" data-v-a1909632>*</span></label><input${d.ssrRenderAttr("value",c.bankAccount)} type="text" class="flex-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" placeholder="请输入" required data-v-a1909632></div></form></div><div class="bg-gray-50 px-6 py-4 flex justify-end space-x-3" data-v-a1909632><button type="button" class="px-5 py-2 rounded-md border border-gray-300 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary" data-v-a1909632> 取消 </button><button type="button" class="px-5 py-2 rounded-md border border-transparent bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" data-v-a1909632> 确定 </button></div></div></div></div>`):t("\x3c!----\x3e")}}}),h=y.setup;y.setup=(a,t)=>{const s=e.useSSRContext();return(s.modules||(s.modules=new Set)).add("components/common/InvoiceDialog.vue"),h?h(a,t):void 0};const w=r(y,[["__scopeId","data-v-a1909632"]]),k={__name:"DeleteConfirmDialog",__ssrInlineRender:!0,props:{show:{type:Boolean,default:!1}},emits:["update:show","confirm"],setup:(a,{emit:t})=>(t,s,o,r)=>{a.show?s(`<div${d.ssrRenderAttrs(e.mergeProps({class:"fixed inset-0 z-50 overflow-y-auto"},r))}><div class="fixed inset-0 bg-black bg-opacity-50 transition-opacity"></div><div class="flex items-center justify-center min-h-screen p-4"><div class="relative bg-white rounded-lg w-full max-w-md"><div class="flex items-center justify-between p-4 border-b"><h3 class="text-lg font-medium">删除</h3><button class="text-gray-400 hover:text-gray-500"><svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div><div class="p-6"><p class="text-gray-600">删除后无法恢复，请谨慎操作。</p></div><div class="flex justify-end gap-4 p-4 border-t"><button class="px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200"> 取消 </button><button class="px-4 py-2 text-sm text-white bg-red-500 rounded-md hover:bg-red-600"> 删除 </button></div></div></div></div>`):s("\x3c!----\x3e")}},I=k.setup;k.setup=(a,t)=>{const s=e.useSSRContext();return(s.modules||(s.modules=new Set)).add("components/common/DeleteConfirmDialog.vue"),I?I(a,t):void 0};const N=n("user",{state:()=>({id:"",nickname:"",email:"",phone:"",avatar:""}),actions:{updateUserInfo(e){Object.assign(this,e)},async fetchUserInfo(){try{const e=await fetch("/api/user"),a=await e.json();this.updateUserInfo(a)}catch(e){console.error("获取用户信息失败:",e)}}}}),C=e.defineComponent({__name:"settings",__ssrInlineRender:!0,setup(a){const t={success:e=>{},error:e=>{},warning:e=>{g({message:e,type:"warning",duration:3e3})}};N(),e.ref(!1);const s=e.ref(!1),o=e.ref(null),r=e.ref(!1),n=e.ref(!1),l=e.reactive({nickname:"yh4513",phone:"186****4513",email:"",avatar:"https://via.placeholder.com/200"}),i=e.ref([{id:1,name:"张三",phone:"13800138000",address:"广东省深圳市南山区科技园南区 1号楼 A座 1001室",isDefault:!0},{id:2,name:"李四",phone:"13900139000",address:"广东省深圳市福田区车公庙 2号街 B栋 2002室",isDefault:!1},{id:3,name:"王五",phone:"13700137000",address:"广东省深圳市宝安区西乡街道 海滨广场 C座 3003室",isDefault:!1},{id:4,name:"赵六",phone:"13600136000",address:"广东省深圳市龙岗区横岗街道 龙园大厦 D座 4004室",isDefault:!1},{id:5,name:"陈七",phone:"13500135000",address:"广东省深圳市罗湖区笋岗街道 城市广场 E座 5005室",isDefault:!1}]),u=e.ref(!1),c=e.ref(!1),v=e.ref(null),p=e.reactive({companyName:"深圳市汉森软件有限公司",taxNumber:"91440300795429977A",address:"深圳市宝安区西乡街道固兴社区航空产业园A栋A201-A301",phone:"0755-28940020",bankName:"招商银行股份有限公司深圳新安支行",bankAccount:"755935091410501"}),handleSaveAddress=async e=>{try{if(e.id)await fetch(`/api/addresses/${e.id}`,{method:"PUT",body:JSON.stringify(e)}),i.value=i.value.map((a=>a.id===e.id?e:a));else{const a=await fetch("/api/addresses",{method:"POST",body:JSON.stringify(e)}),t=await a.json();i.value.push(t)}s.value=!1,t.success(e.id?"地址更新成功":"地址添加成功")}catch(e){console.error("保存地址失败:",e)}},handleSaveInvoice=e=>{console.log("保存开票资料:",e),Object.assign(p,e)},handleDeleteConfirm=async()=>{if(v.value)try{u.value=!0,i.value=i.value.filter((e=>{var a;return e.id!==(null==(a=v.value)?void 0:a.id)})),(()=>{try{localStorage.setItem("addressList",JSON.stringify(i.value))}catch(e){throw e}})(),t.success("地址删除成功"),c.value=!1}catch(e){}finally{u.value=!1,v.value=null}};return(a,t,v,m)=>{t(`<div${d.ssrRenderAttrs(e.mergeProps({class:"container mx-auto py-6 px-4"},m))} data-v-434e7f76><div class="flex justify-between items-center mb-6" data-v-434e7f76><h1 class="text-2xl font-bold" data-v-434e7f76>基本信息</h1></div><div class="bg-white rounded-lg shadow mb-6 overflow-hidden" data-v-434e7f76><div class="p-4 border-b border-gray-200 flex justify-between items-center" data-v-434e7f76><h2 class="text-lg font-semibold" data-v-434e7f76>账号信息</h2>`),n.value?t('<button class="btn-primary text-sm py-1 px-3" data-v-434e7f76> 保存 </button>'):t('<button class="text-blue-500" data-v-434e7f76><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" data-v-434e7f76><path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" data-v-434e7f76></path></svg></button>'),t('</div><div class="p-6" data-v-434e7f76><div class="flex flex-col md:flex-row gap-6" data-v-434e7f76><div class="flex-1" data-v-434e7f76><div class="space-y-4" data-v-434e7f76><div class="flex items-center" data-v-434e7f76><span class="w-24 text-gray-600" data-v-434e7f76>用户昵称</span><div class="flex-1 flex items-center" data-v-434e7f76>'),n.value?t(`<input${d.ssrRenderAttr("value",l.nickname)} type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-v-434e7f76>`):t(`<span class="mr-2" data-v-434e7f76>${d.ssrInterpolate(l.nickname)}</span>`),t(`</div></div><div class="flex items-center" data-v-434e7f76><span class="w-24 text-gray-600" data-v-434e7f76>手机号</span><div class="flex-1" data-v-434e7f76>${d.ssrInterpolate(l.phone)}</div></div><div class="flex items-center" data-v-434e7f76><span class="w-24 text-gray-600" data-v-434e7f76>邮箱</span><div class="flex-1 flex items-center" data-v-434e7f76>`),n.value?t(`<input${d.ssrRenderAttr("value",l.email)} type="email" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-v-434e7f76>`):t(`<span class="mr-2" data-v-434e7f76>${d.ssrInterpolate(l.email)}</span>`),t('</div></div></div></div></div></div></div><div class="bg-white rounded-lg shadow mb-6 overflow-hidden" data-v-434e7f76><div class="p-4 border-b border-gray-200 flex justify-between items-center" data-v-434e7f76><h2 class="text-lg font-semibold" data-v-434e7f76>收货地址</h2></div><div class="divide-y divide-gray-200" data-v-434e7f76>\x3c!--[--\x3e'),d.ssrRenderList(i.value,(e=>{t(`<div class="${d.ssrRenderClass([{"opacity-50":u.value},"p-6 relative hover:bg-gray-50"])}" data-v-434e7f76><div class="flex justify-between" data-v-434e7f76><div class="flex-1" data-v-434e7f76><div class="flex items-center mb-2" data-v-434e7f76><span class="font-medium mr-4" data-v-434e7f76>${d.ssrInterpolate(e.name)}</span><span class="text-gray-600" data-v-434e7f76>${d.ssrInterpolate(e.phone)}</span>`),e.isDefault?t('<span class="ml-2 px-2 py-0.5 text-xs bg-blue-100 text-blue-800 rounded" data-v-434e7f76> 默认 </span>'):t("\x3c!----\x3e"),t(`</div><div class="text-gray-600" data-v-434e7f76>${d.ssrInterpolate(e.address)}</div></div><div class="flex items-center space-x-4 ml-4" data-v-434e7f76>`),e.isDefault?t("\x3c!----\x3e"):t(`<button class="text-blue-500 hover:text-blue-700 whitespace-nowrap disabled:opacity-50"${d.ssrIncludeBooleanAttr(u.value)?" disabled":""} data-v-434e7f76> 设为默认 </button>`),t(`<button class="text-blue-500 hover:text-blue-700 whitespace-nowrap disabled:opacity-50"${d.ssrIncludeBooleanAttr(u.value)?" disabled":""} data-v-434e7f76> 编辑 </button><button class="text-red-500 hover:text-red-700 whitespace-nowrap disabled:opacity-50"${d.ssrIncludeBooleanAttr(u.value)?" disabled":""} data-v-434e7f76> 删除 </button></div></div></div>`)})),t("\x3c!--]--\x3e"),i.value.length<5?t(`<div class="p-4" data-v-434e7f76><button class="w-full py-3 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 transition-colors flex items-center justify-center text-gray-600 hover:text-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"${d.ssrIncludeBooleanAttr(u.value)?" disabled":""} data-v-434e7f76><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-434e7f76><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" data-v-434e7f76></path></svg> 添加新地址 </button></div>`):t('<div class="p-4 text-center text-gray-500 text-sm" data-v-434e7f76> 最多只能添加5个收货地址 </div>'),t(`</div></div><div class="bg-white rounded-lg shadow overflow-hidden" data-v-434e7f76><div class="p-4 border-b border-gray-200 flex justify-between items-center" data-v-434e7f76><h2 class="text-lg font-semibold" data-v-434e7f76>开票资料</h2><button class="text-blue-500" data-v-434e7f76><svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor" data-v-434e7f76><path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" data-v-434e7f76></path></svg></button></div><div class="p-6" data-v-434e7f76><div class="space-y-4" data-v-434e7f76><div class="flex" data-v-434e7f76><span class="w-24 text-gray-600" data-v-434e7f76>公司名称</span><span data-v-434e7f76>${d.ssrInterpolate(p.companyName)}</span></div><div class="flex" data-v-434e7f76><span class="w-24 text-gray-600" data-v-434e7f76>税号</span><span data-v-434e7f76>${d.ssrInterpolate(p.taxNumber)}</span></div><div class="flex" data-v-434e7f76><span class="w-24 text-gray-600" data-v-434e7f76>单位地址</span><span data-v-434e7f76>${d.ssrInterpolate(p.address)}</span></div><div class="flex" data-v-434e7f76><span class="w-24 text-gray-600" data-v-434e7f76>电话号码</span><span data-v-434e7f76>${d.ssrInterpolate(p.phone)}</span></div><div class="flex" data-v-434e7f76><span class="w-24 text-gray-600" data-v-434e7f76>开户银行</span><span data-v-434e7f76>${d.ssrInterpolate(p.bankName)}</span></div><div class="flex" data-v-434e7f76><span class="w-24 text-gray-600" data-v-434e7f76>银行账户</span><span data-v-434e7f76>${d.ssrInterpolate(p.bankAccount)}</span></div></div></div></div>`),t(d.ssrRenderComponent(f,{show:s.value,"editing-address":o.value,"onUpdate:show":e=>s.value=e,onSave:handleSaveAddress},null,v)),t(d.ssrRenderComponent(w,{show:r.value,"invoice-info":p,"onUpdate:show":e=>r.value=e,onSave:handleSaveInvoice},null,v)),t(d.ssrRenderComponent(k,{show:c.value,"onUpdate:show":e=>c.value=e,onConfirm:handleDeleteConfirm},null,v)),t("</div>")}}}),A=C.setup;C.setup=(a,t)=>{const s=e.useSSRContext();return(s.modules||(s.modules=new Set)).add("pages/dashboard/account/settings.vue"),A?A(a,t):void 0};const $=r(C,[["__scopeId","data-v-434e7f76"]]);export{$ as default};
//# sourceMappingURL=settings.vue.mjs.map
